<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Menu</title>
    <link rel="stylesheet" href="../resource/css/style.css">
    <link rel="stylesheet" href="../resource/css/menu.css">
    <script type="module">
        import { play_value_sfx, play_click_sfx } from '../resource/js/common.js';
        window.play_value_sfx = play_value_sfx;
        window.play_click_sfx = play_click_sfx;
    </script>
</head>

<body>
    <div class="menu-container">
        <div class="menu-window">
            <div class="menu-title-bar">
                <div class="menu-title">I Have No Eyes And I Must Stream</div>
            </div>
            <div class="menu-content">
                <h1>I Have No Eyes<br />And I Must Stream</h1>
                <div class="menu-credit">
                    a short <a href="disclaimer/surrealist_sci_fi.html">surrealist sci-fi</a> interactive
                    story/management game<br />
                    with <a href="disclaimer/twitch_live_integration.html">twitch live integration</a> and <a
                        href="disclaimer/scientifically_proven_benefits.html">scientifically proven benefits</a>
                </div>
                <a href="computer.html" class="menu-start-btn" onclick="window.play_click_sfx()">Play</a>

                <div class="menu-volume-control">
                    <label for="volume-slider" class="menu-volume-label">Music:</label>
                    <input type="range" id="volume-slider" min="0" max="100" value="0" class="menu-volume-slider">
                </div>

                <div class="menu-volume-control">
                    <label for="sfx-slider" class="menu-volume-label"> SFX : </label>
                    <input type="range" id="sfx-slider" min="0" max="100" value="0" class="menu-volume-slider">
                </div>

                <div class="menu-credit">
                    By <a href="http://www.yo252yo.com" target="_blank">yo252yo</a> with
                    music by <a href="https://loyaltyfreakmusic.com/" target="_blank">Rrrrrose Azerty</a>.
                    <br />
                    PROTOTYPE - Beta 0.2
                </div>
                <div class="menu-credit">
                    <a href="#"
                        onclick="if(confirm('Are you sure you want to reset all data?')) { localStorage.clear(); setTimeout(() => window.top.location.reload(), 500) }">
                        Start over (reset all data)</a>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Volume changing functions
        function changeMusicVolume(value) {
            const volume = value / 100;
            localStorage.setItem("music_volume", volume.toString());
        }

        function getMusicVolume() {
            return parseFloat(localStorage.getItem("music_volume") || "0.5");
        }

        function changeSFXVolume(value) {
            const volume = value / 100;
            localStorage.setItem('sfx_volume', volume.toString());
            // Play test sound to verify volume
            window.play_value_sfx();
        }

        function getSFXVolume() {
            return parseFloat(localStorage.getItem('sfx_volume') || '0.7');
        }

        // Initialize volumes when page loads
        function initializeVolumes() {
            // Music volume control functionality
            const volumeSlider = document.getElementById('volume-slider');
            if (volumeSlider) {
                volumeSlider.addEventListener('input', function () {
                    changeMusicVolume(volumeSlider.value);
                });

                // Set initial music volume
                try {
                    volumeSlider.value = Math.floor(100 * getMusicVolume());
                } catch {
                    volumeSlider.value = 60; // fallback default
                }
            }

            // SFX volume control functionality
            const sfxSlider = document.getElementById('sfx-slider');
            if (sfxSlider) {
                sfxSlider.addEventListener('input', function () {
                    changeSFXVolume(sfxSlider.value);
                });

                // Set initial SFX volume
                sfxSlider.value = Math.floor(100 * getSFXVolume());
            }
        }

        // Start initialization
        initializeVolumes();
    </script>
</body>

</html>