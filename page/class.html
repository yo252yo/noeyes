<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Class</title>
    <link rel="stylesheet" href="../resource/css/style.css">
    <link rel="stylesheet" href="../resource/css/class.css">
    <script type="module">
        import { getDay, getMaxAllowedDay } from '../resource/js/common.js';

        // Make functions available globally
        window.getDay = getDay;
        window.getMaxAllowedDay = getMaxAllowedDay;

        // Tips dictionary - each day maps to a tip message
        window.tips = {
            "1": "It's time for your first class!<br />Exciting, isn't it?<br />Click on the link right below to get you started!",
            "3": "<b>Did you know?</b><br />A fraction of your simulated <span class='highlight-text'>Economy</span> contributes to the real <span class='highlight-text'>Economy</span>!<br />Larvae are productive too!",
            "4": "How is it going?<br />Now that you know the two <span class='highlight-text'>Gender™</span>, you'll be an expert on the <span class='highlight-text'>Economy</span> in no time!",
            "6": "Now that you know the basics, it's time for the cheat codes!",
            "7": "Time for the Big Choice! Are you ready?",
            "9": "Congratulations!<br />As a memory of your larval stage, feel free to come back and play with your simulation at any time!"
        };

        // Class entries dictionary - each day maps to HTML snippets for class items
        window.classEntries = {
            "1": `<li>
                <a href="classes/1_1.html">
                    <img src="../resource/icons/book.png" style="width:20px; height:20px; margin-right:5px">My First Class
                </a>
            </li>`,
            "2": `<li>
                <a href="classes/2_1.html">
                    <img src="../resource/icons/book.png" style="width:20px; height:20px; margin-right:5px">The Influencers
                </a>
            </li>`,
            "3": `<li>
                <a href="classes/3_1.html">
                    <img src="../resource/icons/book.png" style="width:20px; height:20px; margin-right:5px">Chat
                </a>
            </li>`,
            "4": `<li>
                <a href="classes/4_1.html">
                    <img src="../resource/icons/book.png" style="width:20px; height:20px; margin-right:5px">The Economy
                </a>
            </li>`,
            "5": `<li>
                <a href="classes/5_1.html">
                    <img src="../resource/icons/book.png" style="width:20px; height:20px; margin-right:5px">Gender™ Matchmaking
                </a>
            </li>`,
            "6": `<li>
                <a href="classes/6_1.html">
                    <img src="../resource/icons/book.png" style="width:20px; height:20px; margin-right:5px">Artificial Intelligence
                </a>
            </li>`,
            "7": `<li>
                <a href="classes/7_1.html">
                    <img src="../resource/icons/book.png" style="width:20px; height:20px; margin-right:5px">The Big Choice
                </a>
            </li>`
        };

        window.generateClassContent = function () {
            const currentDay = getDay();
            const maxDay = getMaxAllowedDay();
            const contentDiv = document.getElementById('class-content');

            // Get all entries before or equal to current day
            const availableEntries = [];
            for (let day = 1; day <= currentDay; day++) {
                if (window.classEntries[day.toString()]) {
                    availableEntries.push({
                        day: day,
                        html: window.classEntries[day.toString()]
                    });
                }
            }

            // Display entries in reverse chronological order (newest first)
            availableEntries.reverse();

            let html = '<ul>';
            availableEntries.forEach(entry => {
                let linkHtml = entry.html;
                if (entry.day != maxDay) {
                    linkHtml = linkHtml.replace('<a ', '<a class="old_link" ');
                }
                html += `<li>${linkHtml.replace('<li>', '').replace('</li>', '')}</li>`;
            });
            html += '</ul>';

            contentDiv.innerHTML = html;

            // Generate tip content
            const tipDiv = document.getElementById('tip-content');
            const currentTip = window.tips[currentDay.toString()];
            if (currentTip) {
                tipDiv.innerHTML = `<div class="help-bubble">${currentTip}</div>`;
            } else {
                tipDiv.innerHTML = '';
            }
        };

        // Initialize when DOM is ready
        document.addEventListener('DOMContentLoaded', function () {
            window.generateClassContent();
            // Regenerate class content every 2 seconds to show day changes dynamically
            setInterval(window.generateClassContent, 2000);
        });
    </script>
</head>

<body style="margin: 0; padding: 5px 20px 20px 20px;">
    <h1>Welcome Larva!</h1>
    <div id="tip-content"></div>
    <div id="class-content"></div>


</body>

</html>