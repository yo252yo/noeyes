<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>I Have No Eyes And I Must Stream</title>
    <link rel="stylesheet" href="resource/css/style.css">
    <script>
        var MUSIC_AUDIO = new Audio();
        MUSIC_AUDIO.loop = "loop";
        MUSIC_AUDIO.volume = localStorage.getItem("music_volume") || 0.6;

        MUSIC_AUDIO.src = "resource/Soft and Furious - Bae - 02 Game On.mp3";

        function startMusic() {
            MUSIC_AUDIO.play().catch(function (error) {
                setTimeout(startMusic, 100);
            });
        }
        startMusic();

        function changeMusicVolume(value) {
            MUSIC_AUDIO.volume = value / 100;
            localStorage.setItem("music_volume", MUSIC_AUDIO.volume);
        }

        // SFX functionality at parent level
        var SFX_AUDIO = null;

        function getSFXVolume() {
            const stored = localStorage.getItem('sfx_volume');
            return stored ? parseFloat(stored) : 0.7;
        }

        function setSFXVolume(volume) {
            volume = Math.max(0, Math.min(1, volume));
            localStorage.setItem('sfx_volume', volume.toString());
        }

        function playSFX(soundFile) {
            // Stop any currently playing SFX
            if (SFX_AUDIO) {
                SFX_AUDIO.pause();
                SFX_AUDIO.currentTime = 0;
            }

            // Create new audio element
            SFX_AUDIO = new Audio(soundFile);
            SFX_AUDIO.volume = getSFXVolume();

            // Play the sound
            SFX_AUDIO.play().catch(function (error) {
                console.warn('SFX playback failed:', error);
            });
        }

        function changeSFXVolume(value) {
            const volume = value / 100;
            setSFXVolume(volume);
        }
    </script>
    <script type="module">
        import './resource/js/common.js';
        import './resource/js/twitch.js';
        import './resource/js/twitch_irc.js';
    </script>
</head>

<body style="margin: 0; padding: 0; overflow:hidden">
    <iframe src="page/menu.html" frameborder="0" style="width: 100%; height: 100vh; border: none;"></iframe>
</body>

</html>